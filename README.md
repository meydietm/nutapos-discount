# Nutapos – Discount Management (Frontend)

Implementasi **frontend** untuk fitur **Manajemen Diskon** (home test rekrutmen Nutapos – posisi Fullstack Web Developer).

Aplikasi ini menampilkan **daftar diskon**, **tambah/ubah diskon via dialog**, serta **hapus diskon (single & bulk)**. Data disimpan menggunakan API dummy **crudcrud.com**.

---

## Tech Stack

- **Vue 3** + **Vite**
- **Vuetify 3** (Material Design 3 blueprint)
- **Pinia** (state management)
- **Axios** (HTTP client)
- **crudcrud.com** (temporary REST API)

---

## Fitur

### Daftar Diskon
- Menampilkan total jumlah diskon.
- Pencarian (search) berdasarkan nama.
- Sorting kolom **Nama Diskon** dan **Nilai Diskon**.
- Pagination + pengaturan jumlah data per halaman.
- Chip **"baru"** untuk diskon dengan atribut `isNew: true`.
- **Empty State** jika belum ada data diskon.

### Tambah / Ubah Diskon (Dialog)
- Tambah diskon melalui dialog **Tambah Diskon**.
- Edit diskon melalui dialog **Edit Diskon**.
- Validasi:
  - Nama diskon wajib diisi.
  - **Nama diskon harus unik** (case-insensitive, trim); pada mode edit tidak menghitung dirinya sendiri.
  - Nilai diskon wajib diisi, tidak boleh negatif, dan tidak boleh `0`.
  - Jika tipe persen, maksimum `100%`.
- Perbedaan UI (sesuai Figma):
  - **Tambah**: tombol **Simpan** full-width.
  - **Edit**: tombol **Hapus** (kiri) dan **Simpan** (kanan).

### Hapus Diskon
- **Bulk delete** menggunakan checkbox pada tabel.
- Konfirmasi hapus melalui dialog **Hapus Diskon**.
- Hapus diskon dari dialog edit (single delete).

---

## Data Model

Data diskon yang disimpan ke crudcrud:

```json
{
  "_id": "(generated by crudcrud)",
  "name": "Burger Hemat",
  "type": "percent" | "fixed",
  "value": 25,
  "isNew": true
}
```

Catatan:
- Field `_id` dibuat otomatis oleh crudcrud.
- Atribut `isNew` bersifat opsional. Jika tidak ada, chip "baru" tidak ditampilkan.
- Pada implementasi saat ini, ketika membuat diskon baru, aplikasi akan memastikan hanya **maksimal 1 item** yang memiliki `isNew: true` (item `isNew` lama akan dihapus atributnya lalu di-update).

---

## Menjalankan Project

### Prasyarat
- Node.js 18+ (disarankan)
- npm

### Install & Run

```bash
npm install
npm run dev
```

Akses di browser:
- `http://localhost:5173` (default Vite)

---

## Konfigurasi API (crudcrud.com)

Aplikasi menggunakan base URL dari:
- **Environment variable** `VITE_CRUDCRUD_BASE_URL`, dan/atau
- **API URL** yang di-set dari UI (menu **Kopi Anak Bangsa** → input **API URL crudcrud.com** → **Terapkan**).

### 1) Via `.env`
Buat/ubah file `.env` di root project:

```env
VITE_CRUDCRUD_BASE_URL=https://crudcrud.com/api/<TOKEN>/<COLLECTION>
```

Contoh:
- `https://crudcrud.com/api/xxxxxx/discounts`

> Penting: base URL harus menunjuk ke **collection endpoint** (akhiran `/discounts` atau `/diskon`), bukan hanya `.../api/<TOKEN>`.

### 2) Via UI (disimpan di localStorage)
- Klik tombol **Kopi Anak Bangsa**
- Masukkan API URL (contoh `https://crudcrud.com/api/xxxxxx/discounts`)
- Klik **Terapkan** → aplikasi akan refetch data

Nilai API URL ini disimpan di browser pada key:
- `nutapos.crudcrud.discountUrl`

Untuk reset:
- Set ulang dari UI, atau hapus key tersebut lewat DevTools → Application → Local Storage.

---

## Scripts

- `npm run dev` – menjalankan development server
- `npm run build` – build production (output: `dist/`)
- `npm run preview` – preview build hasil production

---

## Catatan / Troubleshooting

- **crudcrud.com bersifat sementara**: token/endpoint bisa kedaluwarsa. Jika request mulai 404/403, buat token baru dan update URL (via `.env` atau UI).
- Jika data tidak muncul:
  - Pastikan API URL benar dan mengarah ke collection endpoint.
  - Cek Console/Network di DevTools untuk melihat error.

---

## Struktur Folder (ringkas)

```
src/
  app/                # router, vuetify
  assets/             # icon & empty state image
  components/discounts/
    DiscountDialog.vue
    DeleteConfirmDialog.vue
    DiscountEmptyState.vue
  pages/discounts/
    DiscountList.vue
  services/
    http.js           # axios instance + set/get baseURL
    discounts.api.js  # CRUD calls
  stores/
    discounts.store.js
  utils/
    format.js
```
